;/*FB_PKG_DELIM*/

__d("FBXHorizonMetaCastingControllerRouteBuilder",["jsRouteBuilder"],(function(t,n,r,o,a,i,l){var e=r("jsRouteBuilder")("/casting/",Object.freeze({}),void 0),s=e;l.default=s}),98);
__d("HorizonMetaCastingPaths",[],(function(t,n,r,o,a,i){var e=Object.freeze({mainPath:"/casting/",allPaths:["/Casting/","/CASTING/","/cast/","/Cast/","/CAST/","/webcast/","/Webcast/","/WEBCAST/","/webcasting/","/Webcasting/","/WEBCASTING/","/casting/"]});i.default=e}),66);
__d("HorizonMetaIsCastingRoute",["FBXHorizonMetaCastingControllerRouteBuilder","HorizonMetaCastingPaths","URI","isHorizonDotMetaDotComURI"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(){var t=(e||(e=r("URI"))).getRequestURI(),n=r("FBXHorizonMetaCastingControllerRouteBuilder").buildUri({});if(!r("isHorizonDotMetaDotComURI")(t))return!1;var o=r("HorizonMetaCastingPaths").allPaths,a=[].concat(o,[n.getPath()]),i=t.addTrailingSlash().getPath();return a.includes(i)}var u={getIsCastingRoute:s};l.default=u}),98);
__d("LSCutoverMappingQueryFromOpenThreadId",["LSIssueNewTask"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return r[0]=new t.Map,r[0].set("open_thread_id",e[0]),r[1]=r[0].get("open_thread_id"),r[2]=t.toJSON(r[0]),t.storedProcedure(n("LSIssueNewTask"),["cutover_mapping_query_",t.i64.to_string(r[1])].join(""),t.i64.cast([0,180001]),r[2],void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]),void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]))},function(e){return t.resolve(o)}])}e.__sproc_name__="LSE2EEMessagingMetadataMailboxCutoverMappingQueryFromOpenThreadIdStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSCutoverMappingQueryFromOpenThreadIdStoredProcedure",["LSCutoverMappingQueryFromOpenThreadId","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSCutoverMappingQueryFromOpenThreadId"),a.openThreadId);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSVerifyContactExistsWithID",["LSAuthorityLevel","LSContactBlockedByViewerStatus","LSContactGender","LSContactIdType","LSContactType","LSContactViewerRelationship","LSContactWorkForeignEntityType","LSFactory","LSIntEnum","LSPlatformWaitForTaskCompletion","LSVerifyContactRowExistsStoredProcedure","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e,t,n,r){return e.runInTransaction(function(e){return d(t,n,e)},"readwrite",r!=null?r:"background",void 0,i.id+":37")}function u(e,t,n){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){yield r("LSPlatformWaitForTaskCompletion")(e,function(e){return d(t,n,e)},"readwrite")}),c.apply(this,arguments)}function d(t,n,a){return r("LSVerifyContactRowExistsStoredProcedure")(r("LSFactory")(a),{authorityLevel:(e||(e=o("LSIntEnum"))).ofNumber(r("LSAuthorityLevel").CLIENT_PARTIAL),blockedByViewerStatus:e.ofNumber(r("LSContactBlockedByViewerStatus").UNBLOCKED),contactIdType:e.ofNumber(r("LSContactIdType").FBID),contactType:e.ofNumber(r("LSContactType").USER),contactViewerRelationship:e.ofNumber(r("LSContactViewerRelationship").UNKNOWN),gender:e.ofNumber(r("LSContactGender").UNKNOWN),id:t,isBlocked:!1,isMemorialized:!1,isSelf:n,workForeignEntityType:e.ofNumber(r("LSContactWorkForeignEntityType").UNKNOWN)})}l.runInTransaction=s,l.waitForTaskFinish=u,l.callStoredProcedure=d}),98);
__d("LSVerifyThreadExistsV2",["LSGetViewerFBID","LSIssueNewTask"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(n){var o;return[t.i64.cast([0,7]),t.i64.cast([0,8]),t.i64.cast([0,13]),t.i64.cast([0,10]),t.i64.cast([0,11]),t.i64.cast([0,16])].some(function(n){return t.i64.eq(e[1],n)})?t.resolve((o=[!1,!1,!1],r[0]=o[0],r[1]=o[1],r[2]=o[2],o)):t.sequence([function(n){return t.db.table(9).fetch([[[e[0]]]]).next().then(function(n,o){var a,i,l,s,u,c,d,m,p=n.done,_=n.value;return p?(a=[!0,!0,!1],r[3]=a[0],r[4]=a[1],r[5]=a[2],a):(o=_.item,r[12]=o.threadName,r[11]=o.authorityLevel,r[10]=o.threadType,o.folderName==="other"?(i=[!0,!1,!1],r[7]=i[0],r[8]=i[1],r[9]=i[2]):(t.i64.eq(r[10],t.i64.cast([0,0]))&&t.i64.eq(r[11],t.i64.cast([0,40]))||[t.i64.cast([0,23]),t.i64.cast([0,21]),t.i64.cast([0,18]),t.i64.cast([0,26]),t.i64.cast([0,27])].some(function(e){return t.i64.eq(r[10],e)})&&t.i64.neq(r[11],t.i64.cast([0,20]))&&((r[12]===""?void 0:r[12])===void 0||t.i64.lt(r[11],t.i64.cast([0,80])))||[t.i64.cast([0,151]),t.i64.cast([0,155]),t.i64.cast([0,153])].some(function(e){return t.i64.eq(r[10],e)})||[t.i64.cast([0,24]),t.i64.cast([0,22]),t.i64.cast([0,19]),t.i64.cast([0,25]),t.i64.cast([0,28])].some(function(e){return t.i64.eq(r[10],e)})||[t.i64.cast([0,150]),t.i64.cast([0,154]),t.i64.cast([0,152])].some(function(n){return t.i64.eq(e[1],n)})&&t.i64.lt(r[11],t.i64.cast([0,80]))||[t.i64.cast([0,150]),t.i64.cast([0,154]),t.i64.cast([0,152])].some(function(n){return t.i64.eq(e[1],n)})&&t.i64.eq(e[6],t.i64.cast([0,205]))&&t.i64.eq(o.syncGroup,void 0)?(l=[!0,!0,!1],r[13]=l[0],r[14]=l[1],r[15]=l[2]):(t.i64.ge(r[11],e[4])||t.i64.eq(r[11],t.i64.cast([0,20]))&&([t.i64.cast([0,2]),t.i64.cast([0,202]),t.i64.cast([0,206])].some(function(n){return t.i64.eq(e[1],n)})||[t.i64.cast([0,23]),t.i64.cast([0,21]),t.i64.cast([0,18]),t.i64.cast([0,26]),t.i64.cast([0,27])].some(function(n){return t.i64.eq(e[1],n)}))?(s=[!1,!1,!1],r[16]=s[0],r[17]=s[1],r[18]=s[2]):(u=[!0,!1,!0],r[16]=u[0],r[17]=u[1],r[18]=u[2]),c=[r[16],r[17],r[18]],r[13]=c[0],r[14]=c[1],r[15]=c[2]),d=[r[13],r[14],r[15]],r[7]=d[0],r[8]=d[1],r[9]=d[2]),m=[r[7],r[8],r[9]],r[3]=m[0],r[4]=m[1],r[5]=m[2])})},function(e){var t;return t=[r[3],r[4],r[5]],r[0]=t[0],r[1]=t[1],r[2]=t[2],t}])},function(o){return r[0]?(r[3]=new t.Map,r[3].set("thread_fbid",e[0]),r[3].set("force_upsert",e[5]),r[3].set("use_open_messenger_transport",!1),r[3].set("sync_group",e[6]),r[3].set("metadata_only",e[7]),r[3].set("preview_only",!1),r[4]=r[3].get("thread_fbid"),r[5]=t.toJSON(r[3]),t.storedProcedure(n("LSIssueNewTask"),t.i64.to_string(r[4]),t.i64.cast([0,209]),r[5],void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]),void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]))):t.resolve()},function(o){return r[1]?t.sequence([function(n){return t.db.table(9).fetch([[[e[0]]]]).next().then(function(n,o){var a=n.done,i=n.value;return a?t.sequence([function(n){return t.filter(t.db.table(7).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.id,e[0])&&t.i64.eq(t.i64.cast([0,1]),t.i64.cast([0,1]))}).next().then(function(e,n){var o=e.done,a=e.value;return o?r[22]=!1:(n=a.item,r[22]=!!t.i64.eq(n.contactTypeExact,t.i64.cast([0,16])))})},function(e){return r[3]=r[22]}]):(o=i.item,r[3]=!!t.i64.eq(o.threadType,t.i64.cast([0,201])))})},function(n){return t.db.table(9).fetch([[[e[0]]]]).next().then(function(e,n){var o=e.done,a=e.value;return o?r[5]=!1:(n=a.item,r[5]=t.i64.eq(n.threadType,t.i64.cast([0,206])))})},function(n){var o,a,i,l;return r[7]=t.i64.cast([0,1083495711]),r[8]=t.i64.cast([0,1024]),r[9]=t.i64.cast([0,0]),r[10]=t.i64.cast([0,0]),r[11]=t.i64.cast([0,134217728]),r[12]=t.i64.cast([0,1083495711]),r[13]=t.i64.cast([0,1024]),r[14]=t.i64.cast([0,0]),r[15]=t.i64.cast([0,134217728]),r[16]=t.i64.cast([0,0]),r[3]?(r[22]=t.i64.cast([0,8650752]),r[23]=t.i64.cast([0,1024]),r[24]=t.i64.cast([0,0]),r[25]=t.i64.cast([0,0]),r[26]=t.i64.cast([0,0]),o=[r[22],r[23],r[24],r[25],r[26]],r[17]=o[0],r[18]=o[1],r[19]=o[2],r[20]=o[3],r[21]=o[4]):(r[5]?(r[27]=t.i64.cast([0,8700166]),r[28]=t.i64.cast([0,1024]),r[29]=t.i64.cast([0,0]),r[30]=t.i64.cast([0,0]),r[31]=t.i64.cast([0,0]),a=[r[27],r[28],r[29],r[30],r[31]],r[22]=a[0],r[23]=a[1],r[24]=a[2],r[25]=a[3],r[26]=a[4]):(i=[r[12],r[13],r[14],r[15],r[16]],r[22]=i[0],r[23]=i[1],r[24]=i[2],r[25]=i[3],r[26]=i[4]),l=[r[22],r[23],r[24],r[25],r[26]],r[17]=l[0],r[18]=l[1],r[19]=l[2],r[20]=l[3],r[21]=l[4]),t.forEach(t.filter(t.db.table(9).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.threadKey,e[0])&&t.i64.lt(n.authorityLevel,e[4])}),function(e){return e.delete()})},function(n){return t.db.table(9).add({threadKey:e[0],mailboxType:t.i64.cast([0,0]),threadType:e[1],syncGroup:e[6],folderName:e[2],lastReadWatermarkTimestampMs:t.i64.cast([0,0]),removeWatermarkTimestampMs:t.i64.cast([-1,4294967295]),ongoingCallState:t.i64.cast([0,0]),parentThreadKey:e[3],authorityLevel:e[4],capabilities:r[17],capabilities2:r[18],capabilities3:r[19],capabilities4:r[20],capabilities5:r[21],unsendLimitMs:t.i64.cast([-1,4294967295])})},function(o){return[t.i64.cast([0,1]),t.i64.cast([0,201]),t.i64.cast([0,204]),t.i64.cast([0,225])].some(function(n){return t.i64.eq(e[1],n)})?t.sequence([function(n){return t.forEach(t.filter(t.db.table(14).fetch([[[e[0],e[0]]]]),function(n){return t.i64.eq(n.threadKey,e[0])&&t.i64.eq(t.i64.cast([0,0]),t.i64.cast([0,0]))&&t.i64.eq(n.contactId,e[0])&&t.i64.lt(n.authorityLevel,e[4])}),function(e){return e.delete()})},function(n){return t.db.table(14).add({threadKey:e[0],contactId:e[0],readWatermarkTimestampMs:t.i64.cast([0,0]),deliveredWatermarkTimestampMs:t.i64.cast([0,0]),authorityLevel:e[4],isModerator:!1})},function(e){return t.storedProcedure(n("LSGetViewerFBID")).then(function(e){var t;return t=e,r[22]=t[0],t})},function(n){return t.forEach(t.filter(t.db.table(14).fetch([[[e[0],r[22]]]]),function(n){return t.i64.eq(n.threadKey,e[0])&&t.i64.eq(t.i64.cast([0,0]),t.i64.cast([0,0]))&&t.i64.eq(n.contactId,r[22])&&t.i64.lt(n.authorityLevel,e[4])}),function(e){return e.delete()})},function(n){return t.db.table(14).add({threadKey:e[0],contactId:r[22],readWatermarkTimestampMs:t.i64.cast([0,0]),deliveredWatermarkTimestampMs:t.i64.cast([0,0]),authorityLevel:e[4],isModerator:!1})}]):t.resolve()}]):t.resolve()},function(n){return r[2]?t.forEach(t.db.table(9).fetch([[[e[0]]]]),function(t){var n=t.update,r=t.item;return n({authorityLevel:e[4]})}):t.resolve()}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxVerifyThreadExistsV2StoredProcedure",e.__tables__=["threads","contacts","participants"],a.exports=e}),null);
__d("LSVerifyThreadExists",["LSVerifyThreadExistsV2"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(r){return t.storedProcedure(n("LSVerifyThreadExistsV2"),e[0],e[1],e[2],e[3],e[4],!1,e[5],!1,!1)},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxVerifyThreadExistsStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSVerifyThreadRowExists",["LSVerifyThreadExists"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(r){return t.storedProcedure(n("LSVerifyThreadExists"),e[0],e[1]==null?t.i64.cast([0,1]):e[1],"inbox",t.i64.cast([0,0]),t.i64.cast([0,40])==null?t.i64.cast([0,40]):t.i64.cast([0,40]),e[2])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxVerifyThreadRowExistsStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSVerifyThreadRowExistsStoredProcedure",["LSSynchronousPromise","LSVerifyThreadRowExists","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSVerifyThreadRowExists"),a.threadKey,a.threadType,a.syncGroup);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("MAWVerifyThreadCutover_ContactCapabilities2Query_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="9948369021930229"}),null);
__d("MAWVerifyThreadCutover_ContactCapabilities2Query.graphql",["MAWVerifyThreadCutover_ContactCapabilities2Query_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"id"}],t=[{kind:"Variable",name:"id",variableName:"id"}],r={alias:null,args:null,kind:"ScalarField",name:"message_capabilities2_str",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"MAWVerifyThreadCutover_ContactCapabilities2Query",selections:[{alias:null,args:t,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"MAWVerifyThreadCutover_ContactCapabilities2Query",selections:[{alias:null,args:t,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{id:n("MAWVerifyThreadCutover_ContactCapabilities2Query_facebookRelayOperation"),metadata:{},name:"MAWVerifyThreadCutover_ContactCapabilities2Query",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("ReQLSubscribe",["ErrorGuard","ReQL","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,n){var a=t.take(1),i=(e||(e=r("ErrorGuard"))).guard(n),l=!1,s=null,u=a.subscribe(function(e,t){var n;if(!l)switch(t.operation){case"delete":(s==null||s.current!==void 0)&&(s={current:void 0},i(s.current));return;case"add":case"put":((n=s)==null?void 0:n.current)!==t.value&&(s={current:t.value},i(s.current))}});return r("promiseDone")(o("ReQL").firstAsync(a),function(e){!l&&s==null&&(s={current:e},i(e))}),function(){l||(l=!0,u==null||u())}}l.subscribeToFirst=s}),98);
__d("isThreadLevelCutoverEnabled",["qex"],(function(t,n,r,o,a,i,l){"use strict";function e(){return r("qex")._("564")===!0}l.default=e}),98);
__d("MAWVerifyThreadCutover",["CometRelay","FBLogger","I64","LSAuthorityLevel","LSContactBitOffset","LSCutoverMappingQueryFromOpenThreadIdStoredProcedure","LSFactory","LSPlatformWaitForTaskCompletion","LSVerifyContactExistsWithID","MAWDefaultE2eeOneToOneEligibility","MAWVerifyThreadCutover_ContactCapabilities2Query.graphql","Promise","ReQL","ReQLSubscribe","asyncToGeneratorRuntime","ensureContactsExistAndUpdatedSync","err","getErrorSafe","gkx","isThreadLevelCutoverEnabled","justknobx","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=r("justknobx")._("2730"),d=r("justknobx")._("2731"),m=e!==void 0?e:e=n("MAWVerifyThreadCutover_ContactCapabilities2Query.graphql");function p(e,t){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(r("isThreadLevelCutoverEnabled")()){var a=yield e,i=yield o("ReQL").firstAsync(o("ReQL").fromTableAscending(a.tables.mi_act_mapping_table.index("jid")).getKeyRange(t));return i}return(u||(u=n("Promise"))).resolve()}),_.apply(this,arguments)}function f(e,t){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(r("isThreadLevelCutoverEnabled")()){var a=yield e,i=yield(u||(u=n("Promise"))).all([o("ReQL").firstAsync(o("ReQL").fromTableAscending(a.tables.cutover_threads).getKeyRange(t)),o("ReQL").firstAsync(o("ReQL").fromTableAscending(a.tables.contacts).getKeyRange(t))]),l=i[0],s=i[1],c=s!=null&&o("LSContactBitOffset").has(76,s);return l!=null||c}return!1}),g.apply(this,arguments)}function h(e,t){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var a=yield e,i=yield o("ReQL").firstAsync(o("ReQL").fromTableAscending(a.tables.mi_act_mapping_table).getKeyRange(t));if(i==null){var l=null,c=new(u||(u=n("Promise")))(function(e,n){var i=o("ReQLSubscribe").subscribeToFirst(o("ReQL").fromTableAscending(a.tables.mi_act_mapping_table.index("jid")).getKeyRange(t),function(t){t!=null&&(l!=null&&window.clearTimeout(l),i(),e())});l=window.setTimeout(function(){i(),n(r("err")("Timeout"))},d),r("promiseDone")(r("LSPlatformWaitForTaskCompletion")(a,function(e){return r("LSCutoverMappingQueryFromOpenThreadIdStoredProcedure")(r("LSFactory")(e),{openThreadId:t})},"readwrite","cutover_mapping_query_"+(s||(s=o("I64"))).to_string(t)),function(){l!=null&&window.clearTimeout(l),i(),e()})});try{yield c}catch(e){r("FBLogger")("messenger_web").catching(r("getErrorSafe")(e)).warn("Issue waiting for ACT thread to be ready")}yield c}}),y.apply(this,arguments)}function C(e,t,n){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a){var i=yield o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.tables.contacts).getKeyRange(a));if(i!=null&&(s||(s=o("I64"))).ge(i.authorityLevel,(s||(s=o("I64"))).of_int32(r("LSAuthorityLevel").AUTHORITATIVE)))return i;r("promiseDone")(r("ensureContactsExistAndUpdatedSync")(e,t,a));var l=new(u||(u=n("Promise")))(function(t,n){var i=null,l=o("ReQLSubscribe").subscribeToFirst(o("ReQL").fromTableAscending(e.tables.contacts).getKeyRange(a),function(e){e!=null&&(s||(s=o("I64"))).ge(e.authorityLevel,(s||(s=o("I64"))).of_int32(r("LSAuthorityLevel").AUTHORITATIVE))&&(r("FBLogger")("messenger_web").info("Contact retrieval was successful"),i!=null&&window.clearTimeout(i),l(),t(e))});i=window.setTimeout(function(){l(),n(r("err")("Timeout"))},c)});try{i=yield l}catch(t){var d=yield o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.tables.contacts).getKeyRange(a));r("FBLogger")("messenger_web").catching(r("getErrorSafe")(t)).warn("Error retrieving and navigating to the most recent thread: contact exists in LSDB is %s and AuthorityLevel is %s",d!=null,(d==null?void 0:d.authorityLevel)!=null?(s||(s=o("I64"))).to_string(d==null?void 0:d.authorityLevel):"null")}return i}),b.apply(this,arguments)}function v(e,t,n,r){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a,l){var u=yield e;l==null||l("update_contact_capabilities2_db_ready");var c=yield o("ReQL").firstAsync(o("ReQL").fromTableAscending(u.tables.contacts).getKeyRange(t));l==null||l("update_contact_capabilities2_contact_ready");var d=o("LSContactBitOffset").contactCapabilitiesHas(83,(s||(s=o("I64"))).of_string(a)),m=o("LSContactBitOffset").contactCapabilitiesHas(76,s.of_string(a));if(c==null)return r("FBLogger")("messenger_web").warn("contact is null in maybeUpdateContactCapabilities2IfOutOfSync"),(d||m)&&r("FBLogger")("messenger_web").warn("contact is null and they have hasServerCutoverCapabilities as %s and hasServerDefaultE2eeCapabilities as %s from server",m,d),null;var p=o("LSContactBitOffset").contactCapabilitiesHas(83,c.capabilities2),_=o("LSContactBitOffset").contactCapabilitiesHas(76,c.capabilities2);if(d&&!p&&!_||m&&!_){var f=d?"default_e2ee":"cutover";r("FBLogger")("messenger_web").info("sync LS contactCapabilities2 with server value where contactAuthoritativeLevel is %s and serverContactCapabilities2 is %s",(s||(s=o("I64"))).to_string(c.authorityLevel),f);var g=babelHelpers.extends({},c,{capabilities2:s.of_string(a)});return l==null||l("fetch_contact_from_lsdb_start"),yield u.runInTransaction((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){yield e.contacts.put(g)});return function(t){return e.apply(this,arguments)}})(),"readwrite",void 0,void 0,i.id+":304"),g}else r("gkx")("9396")&&r("FBLogger")("messenger_web").info("LS contactCapabilities2 isDefaultE2ee: %s and isCutover: %s is synced with server values where contactAuthoritativeLevel is %s",p,_,(s||(s=o("I64"))).to_string(c.authorityLevel));return c}),S.apply(this,arguments)}function R(e,t,n,r,o){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a,l,c){var d=null,p=null;if(c!=null){var _=c.contactSync;if(_!=null?yield _:yield o("LSVerifyContactExistsWithID").runInTransaction(e,a,!1,void 0,i.id+":336"),l==null||l("verify_contact_exists_with_id_complete"),p=yield c.contactFetch,d=yield c.contactCapabilities,l==null||l("fetch_contact_completed_from_preload"),p!=null&&(s||(s=o("I64"))).ge(p.authorityLevel,(s||(s=o("I64"))).of_int32(r("LSAuthorityLevel").AUTHORITATIVE)))return l==null||l("contact_not_available"),p}else{var f;if(yield o("LSVerifyContactExistsWithID").runInTransaction(e,a,!1,void 0,i.id+":356"),l==null||l("verify_contact_exists_with_id_complete"),p=yield o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.tables.contacts).getKeyRange(a)),l==null||l("fetch_contact_from_db_complete"),p!=null&&(s||(s=o("I64"))).ge(p.authorityLevel,(s||(s=o("I64"))).of_int32(r("LSAuthorityLevel").AUTHORITATIVE)))return l==null||l("contact_not_available"),p;var g=yield o("CometRelay").fetchQuery(t,m,{id:(s||(s=o("I64"))).to_string(a)},{fetchPolicy:"store-or-network"}).toPromise();l==null||l("fetch_contact_capability_from_graphql_complete"),d=g==null||(f=g.user)==null?void 0:f.message_capabilities2_str}if(d==null)return r("gkx")("9396")&&r("FBLogger")("messenger_web").warn("messageCapabilities2Str is null in makeSureContactCapabilitiesIsLoaded"),l==null||l("contact_capability_not_available"),p;var h=yield v((u||(u=n("Promise"))).resolve(e),a,d,l);return l==null||l("update_contact_complete"),h}),L.apply(this,arguments)}function E(e,t,n,r,o){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a,i,l){var c,d=yield e,m=yield C(d,t,a);if(m==null&&r("gkx")("9396")&&r("FBLogger")("messenger_web").warn("contact is null in verifyContactCutoverOrOndemandCutover"),l!=null){var p=yield v((u||(u=n("Promise"))).resolve(d),a,l);p!=null&&(m=p)}var _=l!=null?(s||(s=o("I64"))).of_string(l):(c=m)==null?void 0:c.capabilities2,g=_!=null&&o("LSContactBitOffset").contactCapabilitiesHas(76,_),h=g||(yield f((u||(u=n("Promise"))).resolve(d),a));return h?i===!0?"on_demand_cutover":"cutover":o("MAWDefaultE2eeOneToOneEligibility").isContactDefaultE2eeOneToOneEligible({maybeContact:m})?"default_e2ee":null}),k.apply(this,arguments)}function I(e,t,n){return T.apply(this,arguments)}function T(){return T=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a){var i=yield e,l=yield C(i,t,a);l==null&&r("gkx")("9396")&&r("FBLogger")("messenger_web").warn("contact is null in verifyContactCutoverOrOndemandCutover");var s=yield f((u||(u=n("Promise"))).resolve(i),a);if(s){yield h((u||(u=n("Promise"))).resolve(i),a);var c=yield o("ReQL").firstAsync(o("ReQL").fromTableAscending(i.tables.mi_act_mapping_table).getKeyRange(a));return c==null?"default_e2ee":"cutover"}return o("MAWDefaultE2eeOneToOneEligibility").isContactDefaultE2eeOneToOneEligible({maybeContact:l})?"default_e2ee":null}),T.apply(this,arguments)}function D(e,t){return t==null?(u||(u=n("Promise"))).resolve(!1):f(e,(s||(s=o("I64"))).of_string(t))}l.getCutoverThread=p,l.verifyThreadCutover=f,l.ensureContactCapabilities2IsLoaded=R,l.verifyContactCutoverOrOndemandCutoverOrDefaultE2EE=E,l.verifyContactCutoverOrDefaultE2EEWhenReady=I,l.verifyThreadCutoverWithStringInput=D}),98);
__d("ensureContactsExistAndUpdatedSync",["MAWVerifyThreadCutover","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n,r,o){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a){n!=null&&(r==null||r("update_target_ensure_contact_exists_with_improvements_start"),yield o("MAWVerifyThreadCutover").ensureContactCapabilities2IsLoaded(e,t,n,r,a))}),s.apply(this,arguments)}l.default=e}),98);
__d("MWChatOpenSecureTabForUserCallback",["cr:312"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,r,o,a){if(n("cr:312")==null){a.addMarkerPoint("MAWChatOpenTabForUser_dependency_missing","AppTiming");return}return n("cr:312").openChatTab(e,t,r,o,a)}l.openChatTab=e}),98);
__d("ReStoreDbClosedError",["ClientConsistencyEventEmitter","MAWCurrentUser"],(function(t,n,r,o,a,i,l){"use strict";var e="ReStore DB closed",s=(function(t){function n(n){var a,i=n!=null?n:e;switch(a=t.call(this,i)||this,a.message=i,o("MAWCurrentUser").getAppID()){case 772021112871879:r("ClientConsistencyEventEmitter").emit("hardRefresh","restore_db_closed");break;default:r("ClientConsistencyEventEmitter").emit("softRefresh","restore_db_closed")}return a}return babelHelpers.inheritsLoose(n,t),n})(babelHelpers.wrapNativeSuper(Error));l.default=s}),98);
__d("MWLSPreloadThreadForContact",["FBLogger","I64","LSDatabaseSingleton","LSFactory","LSIntEnum","LSIssueMessagesRangeQueryStoredProcedure","LSMailboxMessagesRangeQueryDirection","LSVerifyThreadRowExistsStoredProcedure","MAWVerifyThreadCutover","Promise","ReQL","ReStoreDbClosedError","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c;function d(t){r("promiseDone")((s||(s=o("LSDatabaseSingleton"))).LSDatabaseSingleton.then(function(a){return a.runInTransaction(function(i){var l=(c||(c=o("I64"))).of_string(t);return o("MAWVerifyThreadCutover").verifyThreadCutover((e||(e=n("Promise"))).resolve(a),l).then(function(e){if(!e)return o("ReQL").firstAsync(o("ReQL").fromTableAscending(i.messages_ranges_v2__generated).getKeyRange(l)).then(function(e){return e!=null?e.minMessageId===e.maxMessageId&&e.minMessageId!==""?r("LSIssueMessagesRangeQueryStoredProcedure")(r("LSFactory")(i),{direction:(u||(u=o("LSIntEnum"))).ofNumber(r("LSMailboxMessagesRangeQueryDirection").BEFORE),referenceTimestampMs:e.minTimestampMs,threadKey:l}):void 0:r("LSVerifyThreadRowExistsStoredProcedure")(r("LSFactory")(i),{syncGroup:(u||(u=o("LSIntEnum"))).ofNumber(1),threadKey:l})})})},"readwrite",void 0,void 0,i.id+":29").catch(function(e){if(e instanceof r("ReStoreDbClosedError"))r("FBLogger")("messenger_web").info("Failed to preload thread, db closed.");else throw e})}))}function m(){return d}l.verifyThreadExists=d,l.usePreloaderForUser=m}),98);
__d("MessengerCreateVideoMeetupLinkMutation_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="9685249484907022"}),null);
__d("MessengerCreateVideoMeetupLinkMutation.graphql",["MessengerCreateVideoMeetupLinkMutation_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"CreateVideoMeetupLinkResponsePayload",kind:"LinkedField",name:"create_video_meetup_link",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerCallInviteLink",kind:"LinkedField",name:"meetup_link",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link_hash",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_audio_only",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"MessengerCreateVideoMeetupLinkMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"MessengerCreateVideoMeetupLinkMutation",selections:t},params:{id:n("MessengerCreateVideoMeetupLinkMutation_facebookRelayOperation"),metadata:{},name:"MessengerCreateVideoMeetupLinkMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("MessengerCreateVideoMeetupLinkMutation",["MessengerCreateVideoMeetupLinkMutation.graphql","Promise","cr:1012418","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t,o,a){return new(s||(s=n("Promise")))(function(i,l){var s,u,c,d,m,p,_,f,g,h,y;n("cr:1012418").commitMutation(t,{mutation:e!==void 0?e:e=n("MessengerCreateVideoMeetupLinkMutation.graphql"),onCompleted:function(t){var e,n,r,o,a=t==null||(e=t.create_video_meetup_link)==null||(e=e.meetup_link)==null?void 0:e.is_audio_only,s=t==null||(n=t.create_video_meetup_link)==null||(n=n.meetup_link)==null?void 0:n.link_url,u=t==null||(r=t.create_video_meetup_link)==null||(r=r.meetup_link)==null?void 0:r.link_hash,c=t==null||(o=t.create_video_meetup_link)==null||(o=o.meetup_link)==null?void 0:o.id;return s!=null&&u!=null&&a!=null?i({isAudioOnly:a,linkHash:u,linkId:c,linkUrl:s}):l({error:"Failed to create linkurl."})},onError:function(t){l(t)},optimisticUpdater:null,variables:{input:{client_mutation_id:"",funnel_session_id:a,link_options:{availability_settings_options:(o==null?void 0:o.linkSurface)==="MESSENGER_V2"?{join_permission:o==null?void 0:o.joinPermission,visibility_mode:(s=o==null?void 0:o.visibilityMode)!=null?s:"NONE"}:void 0,chat_mode:(u=o==null?void 0:o.chatMode)!=null?u:null,is_audio_only:(c=o==null?void 0:o.isAudioOnly)!=null?c:null,is_live_enabled:(d=o==null?void 0:o.isLiveEnabled)!=null?d:null,is_room_join_requestable:(m=o==null?void 0:o.joinRequestable)!=null?m:null,link_surface:(p=o==null?void 0:o.linkSurface)!=null?p:r("gkx")("20836")?"WORKPLACE":void 0,revocation_behavior:(_=o==null?void 0:o.revocationBehavior)!=null?_:null,should_allow_anonymous_guests:(f=o==null?void 0:o.allowAnonymousGuests)!=null?f:!0,supports_pages:(g=o==null?void 0:o.supportsPages)!=null?g:!1,supports_profile_plus:(h=o==null?void 0:o.supportsProfilePlus)!=null?h:!1,visibility_mode:(o==null?void 0:o.linkSurface)==="MESSENGER_V2"?void 0:(y=o==null?void 0:o.visibilityMode)!=null?y:"NONE"}}}})})}l.default=u}),98);
__d("RoomsLinkUtils",["ConstUriUtils"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t,n=o("ConstUriUtils").getUri(e),r=n==null?void 0:n.getDomain(),a=n==null||(t=n.stripTrailingSlash())==null?void 0:t.getPath();if(a==null)return null;if(r==="msngr.com")return a.substring(1);var i=/^\/v(id)?\//;if(r==="m.me"&&i.test(a))return a.replace(i,"");var l=/^\/groupcall\/LINK:/;return l.test(a)?a.replace(l,""):null}l.getRoomsLinkHash=e}),98);
__d("VideoChatLinksUserActionsMultiplexLogger",["cr:1443591"],(function(t,n,r,o,a,i,l){"use strict";l.default=n("cr:1443591")}),98);
__d("VideoChatLinksUserActionsTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(){this.$1={}}var t=e.prototype;return t.log=function(t){n("GeneratedLoggerUtils").log("logger:VideoChatLinksUserActionsLoggerConfig",this.$1,n("Banzai").BASIC,t)},t.logVital=function(t){n("GeneratedLoggerUtils").log("logger:VideoChatLinksUserActionsLoggerConfig",this.$1,n("Banzai").VITAL,t)},t.logImmediately=function(t){n("GeneratedLoggerUtils").log("logger:VideoChatLinksUserActionsLoggerConfig",this.$1,{signal:!0},t)},t.clear=function(){return this.$1={},this},t.getData=function(){return babelHelpers.extends({},this.$1)},t.updateData=function(t){return this.$1=babelHelpers.extends({},this.$1,t),this},t.setCallEndReason=function(t){return this.$1.call_end_reason=t,this},t.setCallID=function(t){return this.$1.call_id=t,this},t.setCameraEnabled=function(t){return this.$1.camera_enabled=t,this},t.setClientAppVersion=function(t){return this.$1.client_app_version=t,this},t.setClientLockStatus=function(t){return this.$1.client_lock_status=t,this},t.setClientMonoTimeMs=function(t){return this.$1.client_mono_time_ms=t,this},t.setClienttime=function(t){return this.$1.clienttime=t,this},t.setComponent=function(t){return this.$1.component=t,this},t.setConferenceNameRaw=function(t){return this.$1.conference_name_raw=t,this},t.setCreationAction=function(t){return this.$1.creation_action=t,this},t.setErrorDetails=function(t){return this.$1.error_details=t,this},t.setErrorType=function(t){return this.$1.error_type=t,this},t.setEvent=function(t){return this.$1.event=t,this},t.setEventDetails=function(t){return this.$1.event_details=n("GeneratedLoggerUtils").serializeMap(t),this},t.setEventFireTimestamp=function(t){return this.$1.event_fire_timestamp=t,this},t.setEventFireTimestampOnClient=function(t){return this.$1.event_fire_timestamp_on_client=t,this},t.setExceptionObject=function(t){return this.$1.exception_object=t,this},t.setExperimentsEnabled=function(t){return this.$1.experiments_enabled=n("GeneratedLoggerUtils").serializeMap(t),this},t.setFalcoBatchSequence=function(t){return this.$1.falco_batch_sequence=t,this},t.setFunnelSessionIDRaw=function(t){return this.$1.funnel_session_id_raw=t,this},t.setGroupID=function(t){return this.$1.group_id=t,this},t.setGroupSize=function(t){return this.$1.group_size=t,this},t.setGuestUserID=function(t){return this.$1.guest_user_id=t,this},t.setKickedUserID=function(t){return this.$1.kicked_user_id=t,this},t.setLinkShareTo=function(t){return this.$1.link_share_to=t,this},t.setLocalCallID=function(t){return this.$1.local_call_id=t,this},t.setMediaDevices=function(t){return this.$1.media_devices=t,this},t.setMicrophoneEnabled=function(t){return this.$1.microphone_enabled=t,this},t.setOpenLinkFrom=function(t){return this.$1.open_link_from=t,this},t.setOpenLinkFromAppVersion=function(t){return this.$1.open_link_from_app_version=t,this},t.setReason=function(t){return this.$1.reason=t,this},t.setReferralSurface=function(t){return this.$1.referral_surface=t,this},t.setRoomIDRaw=function(t){return this.$1.room_id_raw=t,this},t.setServerInfoData=function(t){return this.$1.server_info_data=t,this},t.setSource=function(t){return this.$1.source=t,this},t.setStatus=function(t){return this.$1.status=t,this},t.setSurface=function(t){return this.$1.surface=t,this},t.setTargetedUserIds=function(t){return this.$1.targeted_user_ids=n("GeneratedLoggerUtils").serializeVector(t),this},t.setThreadSyncRoomData=function(t){return this.$1.thread_sync_room_data=n("GeneratedLoggerUtils").serializeMap(t),this},t.setThreadType=function(t){return this.$1.thread_type=t,this},t.setUserIdsToBeRemoved=function(t){return this.$1.user_ids_to_be_removed=n("GeneratedLoggerUtils").serializeVector(t),this},t.setVideoCallLinkHashRaw=function(t){return this.$1.video_call_link_hash_raw=t,this},t.setVideoCallLinkIDRaw=function(t){return this.$1.video_call_link_id_raw=t,this},t.setVideoCallLinkIdentifierRaw=function(t){return this.$1.video_call_link_identifier_raw=t,this},t.setVideoCallLinkURLRaw=function(t){return this.$1.video_call_link_url_raw=t,this},t.updateExtraData=function(t){var e=n("nullthrows")(n("GeneratedLoggerUtils").serializeMap(t));return n("GeneratedLoggerUtils").checkExtraDataFieldNames(e,l),this.$1=babelHelpers.extends({},this.$1,e),this},t.addToExtraData=function(t,n){var e={};return e[t]=n,this.updateExtraData(e)},e})(),l={call_end_reason:!0,call_id:!0,camera_enabled:!0,client_app_version:!0,client_lock_status:!0,client_mono_time_ms:!0,clienttime:!0,component:!0,conference_name_raw:!0,creation_action:!0,error_details:!0,error_type:!0,event:!0,event_details:!0,event_fire_timestamp:!0,event_fire_timestamp_on_client:!0,exception_object:!0,experiments_enabled:!0,falco_batch_sequence:!0,funnel_session_id_raw:!0,group_id:!0,group_size:!0,guest_user_id:!0,kicked_user_id:!0,link_share_to:!0,local_call_id:!0,media_devices:!0,microphone_enabled:!0,open_link_from:!0,open_link_from_app_version:!0,reason:!0,referral_surface:!0,room_id_raw:!0,server_info_data:!0,source:!0,status:!0,surface:!0,targeted_user_ids:!0,thread_sync_room_data:!0,thread_type:!0,user_ids_to_be_removed:!0,video_call_link_hash_raw:!0,video_call_link_id_raw:!0,video_call_link_identifier_raw:!0,video_call_link_url_raw:!0};i.default=e}),66);
__d("XGroupCallControllerRouteBuilder",["jsRouteBuilder"],(function(t,n,r,o,a,i,l){var e=r("jsRouteBuilder")("/groupcall/{?call_context}/",Object.freeze({users_to_ring:[],has_video:!0,initialize_video:!0,auto_join:!1,use_joining_context:!1,has_seen_interstitial:!1,use_dapp:!1,is_e2ee_mandated:!1,use_www:!1}),void 0),s=e;l.default=s}),98);
__d("ZenonAppProvider",["HorizonMetaIsCastingRoute","IGDWebUtils","ZenonActorHooks"],(function(t,n,r,o,a,i,l){"use strict";function e(){return o("IGDWebUtils").isInstagramWebSupportedApp(b())}function s(){return v(b())}function u(){return b()===351299233827255}function c(){return b()===0x74ed7b6f24452}function d(){return b()===518491789147974}function m(){var e=b();return e===0x9d143786e51a6||e===0x399e2d8359725||e===351299233827255&&r("HorizonMetaIsCastingRoute").getIsCastingRoute()}function p(){var e=b();return e===0xc7269b363f3c}function _(){var e=b();return e===772021112871879||e===0x7e36f3fcc43bc}function f(){var e=b();return e===949958857019662||e===0x4d31ba8e7e89d||e===445865345227527}function g(){var e=b();return e===514771569228061||e===436761779744620||e===349974259839838}function h(){var e=b();return e===0x70127cc7da0a0}function y(){return b()===0x5a31088e0c758}function C(){return f()||h()||p()}function b(){var e=o("ZenonActorHooks").ZenonActor.getAppID();return e==null?null:Number(e)}function v(e){return e!=null?e===0x9d143786e51a6||e===0x399e2d8359725||e===351299233827255:!1}l.isInstagramApp=e,l.isOculusApp=s,l.isHorizonApp=u,l.isHorizonWorldsApp=c,l.isCastingCenterApp=d,l.isOculusCastingSite=m,l.isMDCApp=p,l.isMessengerWebApp=_,l.isMetaAI=f,l.isBizWebApp=g,l.isWidgetLiveChatApp=h,l.isWorkplace=y,l.shouldSupportRTPSession=C}),98);
__d("ZenonActorHooks",["CurrentUser","FBLogger","ZenonApp","ZenonAppProvider","gkx"],(function(t,n,r,o,a,i,l){"use strict";var e=null,s=null,u=null,c=!1,d=!1,m=new Set;function p(e,t){t===void 0&&(t="Fallback to CurrentUser"),m.has(e)||(r("FBLogger")("rtc_www").blameToPreviousFrame().info("ZenonActor.%s - %s",e,t),m.add(e))}function _(){return[g.getID(),function(t){p("useZenonActor:setter","This setter should not be used as Zenon should currently doesn't allow switching Actor"),e=t}]}function f(t,n,r){if(n===void 0&&(n=!1),r===void 0&&(r=!1),e!==null){if(d)return;p("initZenonActor","ZenonActor is being reinitalized. This may indicate unneccessary ZenonActorProvider's to RelayEnvironmentProvider's in the component tree.")}d=d||n,c=c||r,typeof t=="string"||typeof t=="number"?(e=t.toString(),s=null,u=null):(t==null?void 0:t.actorID)!=null&&(e=t.actorID.toString(),s=t.name,u=t.shortName)}var g={getAccountID:function(){return g.isInstagramUser()?r("CurrentUser").getEIMU():g.isOculusCastingUser()?r("CurrentUser").getEOCPU():g.isMDCUser()?g.getMDCUserID():r("CurrentUser").getAccountID()},getAppID:function(){return g.isLiveChatOnlyPerson()?String(0x70127cc7da0a0):r("CurrentUser").getAppID()},getID:function(){return g.isInstagramUser()?r("CurrentUser").getEIMU():g.isOculusCastingUser()?r("CurrentUser").getEOCPU():g.isMDCUser()?g.getMDCUserID():g.isHorizonWebUser()?r("CurrentUser").getEPOU():g.isKadabraUser()?r("CurrentUser").getARID():e===null?(p("getID"),r("CurrentUser").getID()):e},getMDCUserID:function(){return r("CurrentUser").getEOCPU()==="0"?r("CurrentUser").getPossiblyNonFacebookUserID():r("CurrentUser").getEOCPU()},getName:function(){return s!=null?s:r("CurrentUser").getName()},getShortName:function(){return u!=null?u:r("CurrentUser").getShortName()},isEmployee:function(){return r("CurrentUser").isEmployee()},isHorizonWebUser:function(){return r("CurrentUser").getEPOU()!==0&&o("ZenonAppProvider").isHorizonApp()},isInstagramUser:function(){return r("CurrentUser").getEIMU()!==0&&o("ZenonAppProvider").isInstagramApp()},isKadabraUser:function(){return r("gkx")("11152")&&r("CurrentUser").getAppID()===String(0x4d31ba8e7e89d)},isLiveChatOnlyPerson:function(){return o("ZenonApp").isSocialPlugin},isLoggedIn:function(){return r("CurrentUser").isLoggedIn()},isLoggedInNow:function(){return r("CurrentUser").isLoggedInNow()},isManagedMetaAccount:function(){return r("CurrentUser").isManagedMetaAccount()},isMDCUser:function(){return r("CurrentUser").getPossiblyNonFacebookUserID()!=="0"&&o("ZenonAppProvider").isMDCApp()},isMessengerCallGuestUser:function(){return r("CurrentUser").isMessengerCallGuestUser()},isOculusCastingUser:function(){return r("CurrentUser").getEOCPU()!==0&&o("ZenonAppProvider").isOculusApp()},isOculusUser:function(){return r("CurrentUser").getEPOU()!==0&&o("ZenonAppProvider").isOculusApp()},isPage:function(){return c},isTestUser:function(){return r("CurrentUser").isTestUser()},isWorkishUser:function(){return r("CurrentUser").isWorkroomsUser()||r("CurrentUser").isWorkUser()},isWorkroomsUser:function(){return r("CurrentUser").isWorkroomsUser()},isWorkUser:function(){return r("CurrentUser").isWorkUser()}};l.useZenonActor=_,l.initZenonActor=f,l.ZenonActor=g}),98);
__d("ZenonCallIdentifiersUtil",["Random"],(function(t,n,r,o,a,i,l){"use strict";function e(){return String(o("Random").uint32()+1)}l.generateZenonClientSessionID=e}),98);
__d("ZenonCallWindowErrors",[],(function(t,n,r,o,a,i){"use strict";var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="ZenonOpeningAnotherCallError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error)),l=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="ZenonConferenceNameMutationFailedError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error)),s=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="ZenonIncompleteControllerParamsError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error)),u=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="ZenonUnsupportedThreadTypeError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error)),c=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="ZenonCannotAcceptInviteError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error)),d=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="ZenonInviteNotFoundError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error)),m=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="ZenonUninitializedError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error));i.OpeningAnotherCallError=e,i.ConferenceNameMutationFailedError=l,i.IncompleteControllerParamsError=s,i.UnsupportedThreadTypeError=u,i.CannotAcceptInviteError=c,i.InviteNotFoundError=d,i.UninitializedError=m}),66);
__d("ZenonPeerID",["invariant"],(function(t,n,r,o,a,i,l,s){"use strict";var e="MW_PEER_ID";function u(t){return t.length>0||s(0,33504),t==="MW_PEER_ID"?e:(isNaN(t)===!1||s(0,33551,t),t)}function c(t){return isNaN(t)||t===e?null:t}l.ZenonMWPeerID=e,l.convertStringToPeerID=u,l.convertPeerIDForLogging=c}),98);
__d("ZenonSignalingProtocol",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum")({MW:"mw",MWPP:"mw++"}),l=e;i.default=l}),66);
__d("randomZenonNonce",["Random"],(function(t,n,r,o,a,i,l){"use strict";var e=2,s=6,u=36,c=2176782336;function d(){for(var t="",n=0;n<e;n++){for(var r=Math.floor(o("Random").random()*c).toString(u);r.length<s;)r="0"+r;t+=r}return t}l.default=d}),98);
__d("ZenonPreCallHookBuilderHelper",["ConstUriUtils","FBLogger","MessengerCreateVideoMeetupLinkMutation","Promise","RoomsLinkUtils","VideoChatLinksUserActionsMultiplexLogger","XGroupCallControllerRouteBuilder","ZenonActorHooks","ZenonCallIdentifiersUtil","ZenonCallWindowErrors","ZenonPeerID","ZenonSignalingProtocol","asyncToGeneratorRuntime","getErrorSafe","gkx","nullthrows","randomZenonNonce"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(e===null)throw new(o("ZenonCallWindowErrors")).UninitializedError;var n=e.callInviteModel,a=e.callWindowController,i=n.getCurrentInvite();if(i===null)throw new(o("ZenonCallWindowErrors")).InviteNotFoundError;if(i.type!=="ringing"||i.context.type!=="thread")throw new(o("ZenonCallWindowErrors")).CannotAcceptInviteError;var l=r("randomZenonNonce")(),s=i.context.thread,u=a.initCall({context:{controllerParams:i.controllerParams,intent:"accept invite"},hideE2eeAttributions:t,isE2eeMandated:i.isE2eeMandated,joinContext:{thread:s!=null?s:{id:"0",type:2},type:"thread"},mediaType:i.requestingVideo?"video":"audio",nonce:l,representedID:i.receiverUserId}),c=u[0],d=u[1];n.accept(l,{isPopupBlocked:c===null}),yield d}),u.apply(this,arguments)}function c(e,t,n,r,o,a){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,a,i,l){if(l===void 0&&(l={allowAnonymousGuests:!r("gkx")("20836")}),e===null)throw new(o("ZenonCallWindowErrors")).UninitializedError;y(i,n,a).setEvent("meetup_attempt_create_meetup").log();try{var s=yield r("MessengerCreateVideoMeetupLinkMutation")(t,l,i),u=s.linkUrl;return u!=null?(y(i,n,a).setEvent("meetup_create_success").setVideoCallLinkURLRaw(u).log(),u):(y(i,n,a).setEvent("meetup_create_failed").log(),u)}catch(e){var c=r("getErrorSafe")(e);throw y(i,n,a).setEvent("meetup_create_failed").log(),y(i,n,a).setEvent("error").setErrorType("LinkCreationError "+c.name).setErrorDetails(c.message).log(),c}}),d.apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=t.actorID,i=t.callback_users,l=t.context,s=t.forceSkipChildLobby,u=s===void 0?!1:s,c=t.funnelSessionID,d=c===void 0?null:c,m=t.hasVideo,p=m===void 0?!0:m,_=t.linkUrl,f=t.referrerContext,y=f===void 0?null:f,C=t.skipLinkUrlRewrite,b=C===void 0?!1:C,v=t.startCallImmediately,S=v===void 0?!1:v,R=t.trigger;if(l===null)throw new(o("ZenonCallWindowErrors")).UninitializedError;var L=l.callWindowController,E=l.incomingRingSDK,k=r("randomZenonNonce")(),I=o("ZenonCallIdentifiersUtil").generateZenonClientSessionID(),T=_;if(!b){var D,x=(D=o("ConstUriUtils").getUri(_))==null?void 0:D.getQueryParam("funnel_session_id"),$=g(_);T=h($,S?k:null,i,x!=null?String(x):d,u,y,a,R,p)}if(T==null)return(e||(e=n("Promise"))).reject("An invalid URI was provided");var P=L.initCall({context:{existingCall:null,intent:"start or join",invitees:[],signalingID:I},joinContext:{linkUrl:T,type:"link"},mediaType:"video",nonce:k,representedID:o("ZenonActorHooks").ZenonActor.getID()}),N=P[0],M=P[1];E.startCallIntent(k,{callTrigger:R!=null?R:"meetup_join",isE2eeMandated:!1,isPopupBlocked:N===null,isVideo:p,peerID:o("ZenonPeerID").ZenonMWPeerID,protocol:r("ZenonSignalingProtocol").MW,signalingID:I}),yield M}),p.apply(this,arguments)}function _(e,t){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=t.existingCall,a=t.extra,i=t.hideE2eeAttributions,l=t.invitees,s=t.isE2eeMandated,u=t.mediaType,c=t.representedID,d=t.thread,m=t.trigger;if(e===null)throw new(o("ZenonCallWindowErrors")).UninitializedError;var p=e.callWindowController,_=e.incomingRingSDK,f=o("ZenonCallIdentifiersUtil").generateZenonClientSessionID(),g=r("randomZenonNonce")(),h=p.initCall({context:{existingCall:n,intent:"start or join",invitees:l,signalingID:f},extra:a,hideE2eeAttributions:i,isE2eeMandated:s,joinContext:{thread:d,type:"thread"},mediaType:u,nonce:g,representedID:c!=null?c:o("ZenonActorHooks").ZenonActor.getID()}),y=h[0],C=h[1];_.startCallIntent(g,{callTrigger:m,isE2eeMandated:s!=null?s:!1,isPopupBlocked:y===null,isVideo:u==="video",peerID:d.type===1?d.id:o("ZenonPeerID").ZenonMWPeerID,protocol:r("ZenonSignalingProtocol").MW,signalingID:f}),yield C}),f.apply(this,arguments)}function g(e){var t=o("RoomsLinkUtils").getRoomsLinkHash(e);return t==null&&r("FBLogger")("rtc_www").mustfix('Could not extract LinkHash from Video Chat Link. Link = "%s"',e),t}function h(e,t,n,o,a,i,l,s,u){if(e==null)return"";var c={call_context:"LINK:"+e,call_trigger:s!=null?s:"",has_video:u,users_to_ring:n!=null?n:[]};return t!=null&&(c.nonce=t),o!=null&&(c.funnel_session_id=o),a===!0&&(c.auto_join=!0),i!=null&&(c.referrer_context=i),l!=null&&(c.av=l),r("nullthrows")(r("XGroupCallControllerRouteBuilder").buildUri(c).getQualifiedUri()).toString()}function y(e,t,n){return new(r("VideoChatLinksUserActionsMultiplexLogger"))().setFunnelSessionIDRaw(e).setSurface(t).setComponent(n)}l.acceptCall=s,l.createMeetup=c,l.joinMeetup=m,l.startCall=_}),98);