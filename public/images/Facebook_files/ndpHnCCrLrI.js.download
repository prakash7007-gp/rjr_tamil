;/*FB_PKG_DELIM*/

__d("CometUnifiedShareSheetDialog.react",["fbt","BaseDivider.react","CometColumn.react","CometColumnItem.react","CometComposerDestinationSelectorContextProvider","CometErrorBoundary.react","CometFeatureKillswitch.react","CometGroupResharesContext","CometLinkSharingContextProvider","CometLinkSharingInlineDisclosureWrapper.react","CometLinkSharingUtil","CometPlaceholder.react","CometRelay","CometSharingLoggingContextProvider","CometTrackingCodeContext","CometTransientDialogProvider.react","CometUFIShareToPageOptionalSwitchingShareableProvider","CometUnifiedShareSheetCloseHandlersContext","CometUnifiedShareSheetDialogQuery$Parameters","CometUnifiedShareSheetDialogQuery.graphql","CometUnifiedShareSheetDialog_story.graphql","CometUnifiedShareSheetErrorState.react","CometUnifiedShareSheetGating","FDSText.react","MAWFetchXMAData","MWChatSearchIssueLightspeedQuery","MWFacebookUserWithoutMessengerAccess","RelayHooks","UnifiedShareSheetComposerPlaceholder.react","UnifiedShareSheetDialogContextProvider","UnifiedShareSheetDialogWrapper.react","UnifiedShareSheetHScrollContainerPlaceholder.react","cr:7605","deferredLoadComponent","gkx","justknobx","react","requireDeferredForDisplay","useCometSharingLoggingProcessRoute","useMergeRefs","useNoRoutingTimeSpentNavigation","usePartialViewImpression","usePopPage","useRefetchablePreloadedQuery","useUnifiedShareSheetLogger"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u,c,d=c||(c=o("react")),m=c,p=m.useCallback,_=m.useEffect,f=m.useMemo,g=m.useRef,h=m.useState,y=r("deferredLoadComponent")(r("requireDeferredForDisplay")("UnifiedShareSheetComposerSection.react").__setRef("CometUnifiedShareSheetDialog.react")),C=r("deferredLoadComponent")(r("requireDeferredForDisplay")("UnifiedShareSheetMessengerSection.react").__setRef("CometUnifiedShareSheetDialog.react")),b=r("deferredLoadComponent")(r("requireDeferredForDisplay")("UnifiedShareSheetSharingOptionsSection.react").__setRef("CometUnifiedShareSheetDialog.react")),v=e!==void 0?e:e=n("CometUnifiedShareSheetDialogQuery.graphql"),S=o("CometUnifiedShareSheetGating").shouldDisableMessengerListRanking()?14:6,R=o("CometLinkSharingUtil").ENABLE_LINK_SHARING_ON_USS||o("CometLinkSharingUtil").ENABLE_LINK_SHARING_ON_BCF;function L(e){var t,a,l,c,m,L,E,k,I,T=e.props,D=e.queries,x=g([]),$=h(!0),P=$[0],N=$[1],M=r("usePopPage")();_(function(){o("MWChatSearchIssueLightspeedQuery").fetchThreadRecommendations().then(function(e){var t=e.filter(function(e){return e.waAddressable!==!1}).slice(0,S);x.current=t,N(!1)}).catch(function(){})},[]);var w=o("CometRelay").useFragment(u!==void 0?u:u=n("CometUnifiedShareSheetDialog_story.graphql"),T.parentStory),A=r("useRefetchablePreloadedQuery")(r("CometUnifiedShareSheetDialogQuery$Parameters"),D.queryReference),F=A[0],O=A[1],B=o("CometRelay").usePreloadedQuery(v,O),W=D.queryReference.variables,q=(t=(a=T.shareableID)!=null?a:B==null||(l=B.link_preview)==null||(l=l.story)==null?void 0:l.post_id)!=null?t:"",U=B==null||(c=B.link_preview)==null||(c=c.story)==null?void 0:c.id,V=f(function(){var e;return(e=T.feedTracking)!=null?e:[""]},[T.feedTracking]),H=p(function(){F(W)},[F,W]),G=r("useCometSharingLoggingProcessRoute")(),z=G.entrypointSessionID,j=G.entrypointTracking,K=o("CometLinkSharingUtil").getProductTypeAndSurfaceByFeedLocation(T.feedLocation),Q=K.productType,X=K.shareSheetSurface,Y=T.onClose,J=r("useUnifiedShareSheetLogger")(),Z=J.onShareFailed,ee=J.onSharesheetImpression,te=J.onUSSAbandon,ne=h(!1),re=ne[0],oe=ne[1],ae=h(!1),ie=ae[0],le=ae[1],se=(m=w==null?void 0:w.url)!=null?m:T.shareableUrl,ue=h(se),ce=ue[0],de=ue[1],me=f(function(){return{originalContentUrl:se,productType:Q,setWrappedShareUrl:de,storyID:U}},[Q,se,U]),pe=n("cr:7605")(me),_e=pe.generateWrappedShareUrl,fe=pe.getWrappedShareUrl,ge=pe.getWrappedShareUrlID,he=g(null);_(function(){if(R&&he.current!==U){var e=fe(U);e!=null?de(e):_e(),he.current=U}},[_e,fe,de,U]);var ye=o("RelayHooks").useRelayEnvironment(),Ce=h(null),be=Ce[0],ve=Ce[1];_(function(){var e=o("MAWFetchXMAData").fetchXMAData(ye,ce,[]);ve(e)},[ye,ce]);var Se=f(function(){return{entry_point:T.feedLocation,feed_tracking:V,shareable_entity_fbid:q,sharing_component_name:"facebook_sharesheet",sharing_component_variant:"unified_share_sheet"}},[T.feedLocation,q,V]),Re=r("usePartialViewImpression")({onImpressionStart:function(){ee(Se)}}),Le=r("useMergeRefs")(T.sharingImpressionRef,Re),Ee=o("useNoRoutingTimeSpentNavigation").useLogNoRoutingTimeSpentNavigationBackward(),ke=o("useNoRoutingTimeSpentNavigation").useLogNoRoutingTimeSpentNavigationReset(),Ie=p(function(){te(Se),Y(),ke()},[Se,Y,te,ke]),Te=g(new Map),De=p(function(){var e=Te.current.keys();for(var t of e){var n=t(Ie);if(n)return}Ie()},[Ie]),xe=o("MWFacebookUserWithoutMessengerAccess").useIsFacebookUserWithoutMessengerAccess(),$e=r("gkx")("22885"),Pe=(w==null?void 0:w.id)!=null&&(w==null?void 0:w.url)!=null?{id:w==null?void 0:w.id,isSponsored:(w==null?void 0:w.sponsored_data)!=null||(w==null?void 0:w.th_dat_spo)!=null,messagingInformTreatmentInfo:{messagingInformTreatmentName:w==null||(L=w.inform_treatment_for_messaging)==null?void 0:L.messaging_inform_treatment_name,treatmentType:w==null||(E=w.inform_treatment_for_messaging)==null?void 0:E.treatment_type},productData:T.productData,shareScrapeData:(k=B.storyLink)==null?void 0:k.share_scrape_data,url:w==null?void 0:w.url}:null,Ne=s._(/*BTDS*/"Messenger \u0b87\u0bb2\u0bcd \u0b85\u0ba9\u0bc1\u0baa\u0bcd\u0baa\u0bc1\u0b99\u0bcd\u0b95\u0bb3\u0bcd"),Me=s._(/*BTDS*/"\u0bae\u0bc6\u0b9a\u0bc7\u0b9c\u0bcd \u0b85\u0ba9\u0bc1\u0baa\u0bcd\u0baa\u0bc1\u0b99\u0bcd\u0b95\u0bb3\u0bcd"),we=s._(/*BTDS*/"Workplace \u0b89\u0bb0\u0bc8\u0baf\u0bbe\u0b9f\u0bb2\u0bbf\u0bb2\u0bcd \u0b85\u0ba9\u0bc1\u0baa\u0bcd\u0baa\u0bc1\u0b99\u0bcd\u0b95\u0bb3\u0bcd"),Ae=xe?Me:Ne;$e&&(Ae=we);var Fe=d.jsx(r("CometErrorBoundary.react"),{fallback:function(t){return d.jsx(r("CometUnifiedShareSheetErrorState.react"),{handleRefresh:H})},onError:function(t){Z(Se)},children:d.jsx(r("CometLinkSharingContextProvider"),{getWrappedShareUrlID:ge,shareSheetSurface:X,wrappedShareUrl:ce,children:d.jsxs(r("CometColumn.react"),{children:[d.jsx(r("CometLinkSharingInlineDisclosureWrapper.react"),{entryPoint:o("CometLinkSharingUtil").LinkSharingDisclosureEntryPointEnum.USS_INLINE_DISCLOSURE,feedTracking:V,linkSharingRef:R?B:null,shareableID:q}),(T==null?void 0:T.isShareToFeedDisabled)!==!0&&d.jsxs(d.Fragment,{children:[d.jsx(r("CometColumnItem.react"),{children:d.jsx(r("CometPlaceholder.react"),{fallback:d.jsx(r("UnifiedShareSheetComposerPlaceholder.react"),{}),name:i.id,children:d.jsx(y,{composerRef:B,dialogParams:{feedLocation:(I=W.feedLocation)!=null?I:void 0,qe_optional_share_to_page:W.qe_optional_share_to_page,storyID:U,url:W.shareableParams.url},feedLocation:T.feedLocation,onClose:Ie,resumedComposerViewState:T.resumedComposerViewState,runtimeDialogProps:T,shareableID:q,shareableUrl:o("CometLinkSharingUtil").ENABLE_LINK_SHARING_ON_USS?ce:se,storyData:Pe})})}),d.jsx(r("CometColumnItem.react"),{paddingTop:0,paddingVertical:8,children:d.jsx(r("BaseDivider.react"),{})})]}),d.jsxs(r("CometFeatureKillswitch.react"),{enableFeature:!re&&!r("justknobx")._("2051"),fallback:null,children:[d.jsx(r("CometColumnItem.react"),{paddingHorizontal:16,paddingVertical:12,children:d.jsx(r("FDSText.react"),{isSemanticHeading:!0,numberOfLines:1,type:"headlineEmphasized3",children:Ae})}),d.jsx(r("CometColumnItem.react"),{paddingHorizontal:0,paddingVertical:8,children:d.jsx(r("CometTransientDialogProvider.react"),{children:d.jsx(r("CometPlaceholder.react"),{fallback:d.jsx(r("UnifiedShareSheetHScrollContainerPlaceholder.react"),{}),name:i.id,children:d.jsx(C,{LSresults:x.current,feedLocation:T.feedLocation,feedTracking:V,isLoading:P,messengerQueryReference:D.messengerQueryReference,onClose:Ie,shareableID:q,shareableUrl:o("CometLinkSharingUtil").ENABLE_LINK_SHARING_ON_USS?ce:se,storyData:Pe,xmaDataPromise:be})})})})]}),d.jsxs(r("CometFeatureKillswitch.react"),{enableFeature:!ie,fallback:null,children:[d.jsx(r("CometColumnItem.react"),{paddingHorizontal:16,paddingVertical:12,children:d.jsx(r("FDSText.react"),{isSemanticHeading:!0,numberOfLines:1,type:"headlineEmphasized3",children:s._(/*BTDS*/"\u0b87\u0b99\u0bcd\u0b95\u0bc1 \u0baa\u0b95\u0bbf\u0bb0\u0bc1\u0b99\u0bcd\u0b95\u0bb3\u0bcd:")})}),d.jsx(r("CometColumnItem.react"),{paddingHorizontal:0,paddingVertical:8,children:d.jsx(r("CometPlaceholder.react"),{fallback:d.jsx(r("UnifiedShareSheetHScrollContainerPlaceholder.react"),{}),name:i.id,children:d.jsx(b,{feedLocation:T.feedLocation,feedTracking:V,onBeforeOpen:T.onBeforeSharingOptionOpen,onClose:Ie,shareMenuQueryReference:B,shareableID:q,shareableUrl:o("CometLinkSharingUtil").ENABLE_LINK_SHARING_ON_USS?ce:se,storyData:Pe})})})]})]})})}),Oe=d.jsx(r("CometSharingLoggingContextProvider"),{sessionID:z,tracking:j,children:d.jsx(r("UnifiedShareSheetDialogContextProvider"),{isShareSheetEntrypoint:!0,setShouldHideMessengerSection:oe,setShouldHideShareToSection:le,children:d.jsx(r("CometComposerDestinationSelectorContextProvider"),{children:d.jsx(r("CometUFIShareToPageOptionalSwitchingShareableProvider"),babelHelpers.extends({},T.cometUFIShareToPageOptionalSwitchingShareableProviderProps,{children:d.jsx(o("CometGroupResharesContext").Provider,{feedLocation:T.feedLocation,children:d.jsx(r("CometUnifiedShareSheetCloseHandlersContext").Provider,{value:Te,children:d.jsx(r("UnifiedShareSheetDialogWrapper.react"),{content:Fe,impressionRef:Le,onCloseCentralHandler:De,openUSSPushPage:T.openUSSPushPage,popPage:function(){M==null||M(),Ee()}})})})}))})})}),Be=T.trackingCodes;return Be!=null?d.jsx(r("CometTrackingCodeContext").Provider,{value:Be,children:Oe}):Oe}L.displayName=L.name+" [from "+i.id+"]",l.default=L}),226);